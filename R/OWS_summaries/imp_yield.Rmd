---
date: "`r format(Sys.time(), '%m/%d/%Y')`"
author: ""
title: "`r params$doc_title`"
output: 
  officedown::rdocx_document:
    mapstyles:
      Normal: ['First Paragraph']
    page_margins:
      bottom: 0.5
      top: 0.5
      right: 1
      left: 0.5
      header: 0.0
      footer: 0.0
params: 
  doc_title: "DEQ/OWS Yield Analysis - [INSERT PROJECT NAME HERE]"
  model_features: 73112 # Ex: Blue Ridge Shadows = 71977, BIG STONE GAP WTP = 72672: "runid_6014"
  scenarios: [ "runid_400"]
  model_version: "vahydro-1.0"
  image_names: [ "fig.unmet_heatmap_amt", "fig.imp_storage.all", "fig.monthly_demand" ]
  column_descriptions: [ "Unmet Demand", "Storage by Year", "Monthly Demand" ]
---
```{r setup, include=FALSE}
# load libraries
library("hydrotools")
library("openmi.om")
library("jsonlite")
library("knitr")
# set up data source access
basepath='/var/www/R'
source('/var/www/R/config.R')
ds <- RomDataSource$new("http://deq1.bse.vt.edu/d.dh", rest_uname)
ds$get_token(rest_pw)
ds$json_obj_url <- json_obj_url
# select entities and info to display
model_features <- params$model_features
scenarios <- params$scenarios
image_names <- params$image_names
model_version <- params$model_version
column_descriptions <- params$column_descriptions

# load up the models into the data source (they are cahed in ds$prop_json_cache)
model_pids = list()
for (i in 1:length(model_features)) {
  hid<- model_features[[i]]
  message(i)
  model <- RomProperty$new(ds,list(featureid=hid, propcode=model_version),TRUE)
  ds$get_json_prop(model$pid)
  model_pids[[i]] <- model$pid
}
itable = om_multi_image_list(ds, model_pids, scenarios, image_names, column_descriptions)
img_table = om_rmd_img_table(itable,2)

```

\newpage
# Model Overview and Scenario Descriptions

```{r ModelOverview, echo=FALSE, results = "asis"}

kable(img_table)

```