minorbasin_layer +
RSeg_layer_geom +
nhdplus_flowlines_geom +
# well_1_geom +
# #well_1_point_label +
# well_2_geom +
# #well_2_point_label +
# well_3_geom +
# #well_3_point_label +
intake_1_geom + intake_1_label +
intake_2_geom + intake_2_label +
intake_3_geom + intake_3_label +
# transfer_geom +
# #transfer_point_label +
# usgs_02055000_geom + usgs_02055000_point_label +
# usgs_02054530_geom + usgs_02054530_point_label +
theme(legend.position = c(1.16, 0.833),
legend.title=element_text(size=10),
legend.text=element_text(size=10)) +
# scale_colour_manual(name = c("Legend"),
#                     values = c("gray30","dodgerblue3","black"),
#                     labels = c("River Segments","NHDPlus","Intake"),
#                     guide = guide_legend(override.aes = list(linetype = c("solid","solid","blank"),
#                                                              alpha = c(1,1,1),
#                                                              shape = c(NA,NA,16)))) +
scale_colour_manual(name = c("Legend"),
values = c("gray30","black"),
labels = c("River Segments","Intake"),
guide = guide_legend(override.aes = list(linetype = c("solid","blank"),
alpha = c(1,1),
shape = c(NA,16)))) +
ggsn::scalebar(bb.gg, location = 'bottomleft', dist = 1, dist_unit = 'mi',transform = TRUE, model = 'WGS84',
st.bottom=FALSE,st.size = 3.5, st.dist = 0.0285,anchor = c(x = extent$x[1]+0.058,y = extent$y[1]+0.002))
######################################################################################################
deqlogo <- draw_image(paste(github_location,'/HARParchive/GIS_layers/HiResDEQLogo.tif',sep=''),scale = 0.175, height = 1, x = -.388, y = -0.413) #LEFT BOTTOM LOGO
minorbasin_map <- ggdraw(minorbasin_map)+deqlogo
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
######################################################################################################
minorbasin_map <- basemap.obj +
minorbasin_layer +
RSeg_layer_geom +
nhdplus_flowlines_geom +
# well_1_geom +
# #well_1_point_label +
# well_2_geom +
# #well_2_point_label +
# well_3_geom +
# #well_3_point_label +
intake_1_geom + intake_1_label +
intake_2_geom + intake_2_label +
intake_3_geom + intake_3_label +
# transfer_geom +
# #transfer_point_label +
# usgs_02055000_geom + usgs_02055000_point_label +
# usgs_02054530_geom + usgs_02054530_point_label +
theme(legend.position = c(1.16, 0.833),
legend.title=element_text(size=10),
legend.text=element_text(size=10)) +
# scale_colour_manual(name = c("Legend"),
#                     values = c("gray30","dodgerblue3","black"),
#                     labels = c("River Segments","NHDPlus","Intake"),
#                     guide = guide_legend(override.aes = list(linetype = c("solid","solid","blank"),
#                                                              alpha = c(1,1,1),
#                                                              shape = c(NA,NA,16)))) +
scale_colour_manual(name = c("Legend"),
values = c("gray30","black"),
labels = c("River Segments","Intake"),
guide = guide_legend(override.aes = list(linetype = c("solid","blank"),
alpha = c(1,1),
shape = c(NA,16)))) +
ggsn::scalebar(bb.gg, location = 'bottomleft', dist = 1, dist_unit = 'mi',transform = TRUE, model = 'WGS84',
st.bottom=FALSE,st.size = 3.5, st.dist = 0.0285,anchor = c(x = extent$x[1]+0.05,y = extent$y[1]+0.002))
######################################################################################################
deqlogo <- draw_image(paste(github_location,'/HARParchive/GIS_layers/HiResDEQLogo.tif',sep=''),scale = 0.175, height = 1, x = -.388, y = -0.413) #LEFT BOTTOM LOGO
minorbasin_map <- ggdraw(minorbasin_map)+deqlogo
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
######################################################################################################
minorbasin_map <- basemap.obj +
minorbasin_layer +
RSeg_layer_geom +
nhdplus_flowlines_geom +
# well_1_geom +
# #well_1_point_label +
# well_2_geom +
# #well_2_point_label +
# well_3_geom +
# #well_3_point_label +
intake_1_geom + intake_1_label +
intake_2_geom + intake_2_label +
intake_3_geom + intake_3_label +
# transfer_geom +
# #transfer_point_label +
# usgs_02055000_geom + usgs_02055000_point_label +
# usgs_02054530_geom + usgs_02054530_point_label +
theme(legend.position = c(1.16, 0.833),
legend.title=element_text(size=10),
legend.text=element_text(size=10)) +
# scale_colour_manual(name = c("Legend"),
#                     values = c("gray30","dodgerblue3","black"),
#                     labels = c("River Segments","NHDPlus","Intake"),
#                     guide = guide_legend(override.aes = list(linetype = c("solid","solid","blank"),
#                                                              alpha = c(1,1,1),
#                                                              shape = c(NA,NA,16)))) +
scale_colour_manual(name = c("Legend"),
values = c("gray30","black"),
labels = c("River Segments","Intake"),
guide = guide_legend(override.aes = list(linetype = c("solid","blank"),
alpha = c(1,1),
shape = c(NA,16)))) +
ggsn::scalebar(bb.gg, location = 'bottomleft', dist = 1, dist_unit = 'mi',transform = TRUE, model = 'WGS84',
st.bottom=FALSE,st.size = 3.5, st.dist = 0.0285,anchor = c(x = extent$x[1]+0.04,y = extent$y[1]+0.002))
######################################################################################################
deqlogo <- draw_image(paste(github_location,'/HARParchive/GIS_layers/HiResDEQLogo.tif',sep=''),scale = 0.175, height = 1, x = -.388, y = -0.413) #LEFT BOTTOM LOGO
minorbasin_map <- ggdraw(minorbasin_map)+deqlogo
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
######################################################################################################
minorbasin_map <- basemap.obj +
minorbasin_layer +
RSeg_layer_geom +
nhdplus_flowlines_geom +
# well_1_geom +
# #well_1_point_label +
# well_2_geom +
# #well_2_point_label +
# well_3_geom +
# #well_3_point_label +
intake_1_geom + intake_1_label +
intake_2_geom + intake_2_label +
intake_3_geom + intake_3_label +
# transfer_geom +
# #transfer_point_label +
# usgs_02055000_geom + usgs_02055000_point_label +
# usgs_02054530_geom + usgs_02054530_point_label +
theme(legend.position = c(1.16, 0.833),
legend.title=element_text(size=10),
legend.text=element_text(size=10)) +
# scale_colour_manual(name = c("Legend"),
#                     values = c("gray30","dodgerblue3","black"),
#                     labels = c("River Segments","NHDPlus","Intake"),
#                     guide = guide_legend(override.aes = list(linetype = c("solid","solid","blank"),
#                                                              alpha = c(1,1,1),
#                                                              shape = c(NA,NA,16)))) +
scale_colour_manual(name = c("Legend"),
values = c("gray30","black"),
labels = c("River Segments","Intake"),
guide = guide_legend(override.aes = list(linetype = c("solid","blank"),
alpha = c(1,1),
shape = c(NA,16)))) +
ggsn::scalebar(bb.gg, location = 'bottomleft', dist = 1, dist_unit = 'mi',transform = TRUE, model = 'WGS84',
st.bottom=FALSE,st.size = 3.5, st.dist = 0.0285,anchor = c(x = extent$x[1]+0.045,y = extent$y[1]+0.002))
######################################################################################################
deqlogo <- draw_image(paste(github_location,'/HARParchive/GIS_layers/HiResDEQLogo.tif',sep=''),scale = 0.175, height = 1, x = -.388, y = -0.413) #LEFT BOTTOM LOGO
minorbasin_map <- ggdraw(minorbasin_map)+deqlogo
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
######################################################################################################
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
ggsave(plot = minorbasin_map, file = paste0(export_path,"Rt58_map.png",sep = ""), width=6.5, height=4.95)
dev.off()
export_path <- "C:/Users/nrf46657/Desktop/VAHydro Development/GitHub/vahydro/R/permitting/Route 58/"
batch_list <- list(list(runid = 600,legend_text = "test run")
)
i <- 1
runid_i <- batch_list[[i]]$runid
legend_text_i <- batch_list[[i]]$legend_text
rseg_dat <- om_get_rundata(rseg_om_id, runid_i, site = omsite)
rseg_df <- data.frame(rseg_dat)
rseg_df <- cbind("date" = rownames(rseg_df),rseg_df)
fac_dat <- om_get_rundata(fac_om_id, runid_i, site = omsite)
fac_df <- data.frame(fac_dat)
fac_df <- cbind("date" = rownames(fac_df),fac_df)
library('hydrotools')
library('zoo')
basepath='/var/www/R';
source("/var/www/R/config.R")
site <- "http://deq1.bse.vt.edu:81"
################################################################################################
# LOAD MODEL IDs:
rseg_om_id <- 352147
fac_om_id <- 352155
#runid <- 601
runid <- 600
dev.off()
export_path <- "C:/Users/nrf46657/Desktop/VAHydro Development/GitHub/vahydro/R/permitting/Route 58/"
batch_list <- list(list(runid = 600,legend_text = "test run")
)
i <- 1
runid_i <- batch_list[[i]]$runid
legend_text_i <- batch_list[[i]]$legend_text
################################################################################################
# RETRIEVE RSEG AND FAC DATA, JOIN INTO ONE TABLE
rseg_dat <- om_get_rundata(rseg_om_id, runid_i, site = omsite)
rseg_df <- data.frame(rseg_dat)
rseg_df <- cbind("date" = rownames(rseg_df),rseg_df)
fac_dat <- om_get_rundata(fac_om_id, runid_i, site = omsite)
fac_df <- data.frame(fac_dat)
fac_df <- cbind("date" = rownames(fac_df),fac_df)
rseg_df$Qnatural
rseg_df$Qout
fac_df$Qnatural
library('hydrotools')
library('zoo')
basepath='/var/www/R';
source("/var/www/R/config.R")
site <- "http://deq1.bse.vt.edu:81"
################################################################################################
# LOAD MODEL IDs:
rseg_om_id <- 352147
fac_om_id <- 352155
#runid <- 601
runid <- 600
rseg.dat <- om_get_rundata(elid=rseg_om_id,runid=runid,site=site) #automatically cuts out model warm-up periods
rseg.dat.df <- data.frame(rseg.dat)
quantile(rseg.dat.df$local_channel_Qout, probs=c(0,0.1,0.25,0.5,0.75,0.9,1.0))
rseg_qa <- sqldf("select year,month,day, local_channel_Qout, Qlocal, Qreach
from 'rseg.dat.df' WHERE year = 2001 AND month = 11")
View(rseg_qa)
colnames(rseg.dat.df)
fac_df$Qnatural
rseg_df$Qnatural
colnames(rseg.dat.df)
rseg_df$Qout
colnames(rseg.dat.df)
rseg_qa <- sqldf("select year,month,day, local_channel_Qout, Qlocal, Qreach, Qout
from 'rseg.dat.df' WHERE year = 2001 AND month = 11")
View(rseg_qa)
rseg_qa <- sqldf("select year,month,day, local_channel_Qout, Qlocal, Qreach, Qout
from 'rseg.dat.df' WHERE year = 2001 AND month = 11")
rseg.dat.df$Qnatural
rseg.dat.df$Qout
coln
colnames(rseg.dat.df)
library('hydrotools')
library('zoo')
basepath='/var/www/R';
source("/var/www/R/config.R")
site <- "http://deq1.bse.vt.edu:81"
################################################################################################
# LOAD MODEL IDs:
rseg_om_id <- 352147
fac_om_id <- 352155
#runid <- 601
runid <- 600
dev.off()
export_path <- "C:/Users/nrf46657/Desktop/VAHydro Development/GitHub/vahydro/R/permitting/Route 58/"
batch_list <- list(list(runid = 600,legend_text = "test run")
)
#i <- 1
for (i in 1:length(batch_list)) {
runid_i <- batch_list[[i]]$runid
legend_text_i <- batch_list[[i]]$legend_text
################################################################################################
# RETRIEVE RSEG AND FAC DATA, JOIN INTO ONE TABLE
rseg_dat <- om_get_rundata(rseg_om_id, runid_i, site = omsite)
rseg_df <- data.frame(rseg_dat)
rseg_df <- cbind("date" = rownames(rseg_df),rseg_df)
# fac_dat <- om_get_rundata(fac_om_id, runid_i, site = omsite)
# fac_df <- data.frame(fac_dat)
# fac_df <- cbind("date" = rownames(fac_df),fac_df)
#
# dat_join <- sqldf(
#   paste(
#     "SELECT *
#   FROM rseg_df AS a
#   LEFT OUTER JOIN fac_df AS b
#   ON a.date = b.date")
# )
dat_join <- rseg_df
################################################################################################
# FLOW DURATION CURVE PLOTS ---------------------------------------------------
png(file=paste(export_path,"fdc_",runid_i,".png",sep=""),width=560, height=450)
hydroTSM::fdc(
cbind(dat_join$Qlocal, dat_join$Qout),
#cbind(dat_join$Qnatural, dat_join$Qout),
yat = c(0.10,1,5,10,25,100,400),
leg.txt = c("Flow (Natural)",legend_text_i),
ylab = "Q, [cfs]",
ylim=c(0.01, 500)
)
dev.off()
# DROUGHT PERIOD PLOT
# # REGULAR Y-AXIS ------------------------------------------------------------
# #xmn <- as.Date('1999-01-01')
# #xmx <- as.Date('1999-12-31')
# xmn <- as.Date('2001-01-01')
# xmx <- as.Date('2001-12-31')
# png(paste(export_path,"/hydrograph_Qreach_Qout_",xmn,"_",xmx,"_",runid_i,".png",sep=""), width = 1100, height = 600)
# #png(paste(export_path,"/hydrograph_Qnatural_Qintake_",xmn,"_",xmx,"_",runid_i,".png",sep=""), width = 1100, height = 600)
# ymn <- 0
# ymx <- 110
# par(mar = c(5,5,2,5))
# plot(as.numeric(fac_df$Qreach)~as.Date(fac_df$date),type = "l", lty=2, lwd = 1,
#      ylim=c(ymn,ymx),xlim=c(xmn,xmx),ylab="Flow (cfs)",xlab=paste("\nDate\n",xmn,"to",xmx))
# par(new = TRUE)
# plot(as.numeric(fac_df$Qout)~as.Date(fac_df$date),type = "l",col='brown3', lwd = 2,
#      axes=FALSE,ylim=c(ymn,ymx),xlim=c(xmn,xmx),ylab="",xlab="")
# legend("topright",legend=c("Flow (Natural)",legend_text_i),col=c("black","brown3"), lty=c(2,1), lwd=c(1,2), cex=1)
# dev.off()
# LOG Y-AXIS ------------------------------------------------------------
xmn <- as.Date('2001-01-01')
xmx <- as.Date('2001-12-31')
png(paste(export_path,"/hydrograph_Qreach_Qout_",xmn,"_",xmx,"_",runid_i,"_log.png",sep=""), width = 1100, height = 600)
ymn <- 0
ymx <- 110
par(mar = c(5,5,2,5))
plot(as.numeric(rseg_df$Qreach)~as.Date(rseg_df$date), log="y",type = "l", lty=2, lwd = 1,
xlim=c(xmn,xmx),ylab="Flow (cfs)",xlab=paste("\nDate\n",xmn,"to",xmx))
par(new = TRUE)
plot(as.numeric(rseg_df$Qout)~as.Date(rseg_df$date), log="y",type = "l",col='brown3', lwd = 2,
axes=FALSE,xlim=c(xmn,xmx),ylab="",xlab="")
legend("topright",legend=c("Qreach","Qout"),col=c("black","brown3"), lty=c(2,1), lwd=c(1,2), cex=1)
dev.off()
# WET PERIOD PLOT
# # REGULAR Y-AXIS ------------------------------------------------------------
# xmn <- as.Date('2003-01-01')
# xmx <- as.Date('2003-12-31')
# png(paste(export_path,"/hydrograph_Qnatural_Qintake_",xmn,"_",xmx,"_",runid_i,".png",sep=""), width = 1100, height = 600)
# ymn <- 0
# ymx <- 110
# par(mar = c(5,5,2,5))
# plot(as.numeric(fac_df$Qnatural)~as.Date(fac_df$date),type = "l", lty=2, lwd = 1,
#      ylim=c(ymn,ymx),xlim=c(xmn,xmx),ylab="Flow (cfs)",xlab=paste("\nDate\n",xmn,"to",xmx))
# par(new = TRUE)
# plot(as.numeric(fac_df$Qintake)~as.Date(fac_df$date),type = "l",col='brown3', lwd = 2, axes=FALSE,ylim=c(ymn,ymx),xlim=c(xmn,xmx),ylab="",xlab="")
# legend("topright",legend=c("Flow (Natural)",legend_text_i),col=c("black","brown3"), lty=c(2,1), lwd=c(1,2), cex=1)
# dev.off()
# LOG Y-AXIS ------------------------------------------------------------
xmn <- as.Date('2003-01-01')
xmx <- as.Date('2003-12-31')
png(paste(export_path,"/hydrograph_Qnatural_Qintake_",xmn,"_",xmx,"_",runid_i,"_log.png",sep=""), width = 1100, height = 600)
ymn <- 0
ymx <- 110
par(mar = c(5,5,2,5))
plot(as.numeric(rseg_df$Qreach)~as.Date(rseg_df$date), log="y",type = "l", lty=2, lwd = 1,
xlim=c(xmn,xmx),ylab="Flow (cfs)",xlab=paste("\nDate\n",xmn,"to",xmx))
par(new = TRUE)
plot(as.numeric(rseg_df$Qout)~as.Date(rseg_df$date), log="y",type = "l",col='brown3', lwd = 2,
axes=FALSE,xlim=c(xmn,xmx),ylab="",xlab="")
legend("topright",legend=c("Qreach","Qout"),col=c("black","brown3"), lty=c(2,1), lwd=c(1,2), cex=1)
dev.off()
}
################################################################################################
dev.off()
export_path <- "C:/Users/nrf46657/Desktop/VAHydro Development/GitHub/vahydro/R/permitting/Route 58/"
batch_list <- list(list(runid = 600,legend_text = "test run")
)
#i <- 1
for (i in 1:length(batch_list)) {
runid_i <- batch_list[[i]]$runid
legend_text_i <- batch_list[[i]]$legend_text
################################################################################################
# RETRIEVE RSEG AND FAC DATA, JOIN INTO ONE TABLE
rseg_dat <- om_get_rundata(rseg_om_id, runid_i, site = omsite)
rseg_df <- data.frame(rseg_dat)
rseg_df <- cbind("date" = rownames(rseg_df),rseg_df)
# fac_dat <- om_get_rundata(fac_om_id, runid_i, site = omsite)
# fac_df <- data.frame(fac_dat)
# fac_df <- cbind("date" = rownames(fac_df),fac_df)
#
# dat_join <- sqldf(
#   paste(
#     "SELECT *
#   FROM rseg_df AS a
#   LEFT OUTER JOIN fac_df AS b
#   ON a.date = b.date")
# )
dat_join <- rseg_df
################################################################################################
# FLOW DURATION CURVE PLOTS ---------------------------------------------------
png(file=paste(export_path,"fdc_",runid_i,".png",sep=""),width=560, height=450)
hydroTSM::fdc(
cbind(dat_join$Qlocal, dat_join$Qout),
#cbind(dat_join$Qnatural, dat_join$Qout),
yat = c(0.10,1,5,10,25,100,400),
leg.txt = c("Qlocal","Qout"),
ylab = "Q, [cfs]",
ylim=c(0.01, 500)
)
dev.off()
# DROUGHT PERIOD PLOT
# # REGULAR Y-AXIS ------------------------------------------------------------
# #xmn <- as.Date('1999-01-01')
# #xmx <- as.Date('1999-12-31')
# xmn <- as.Date('2001-01-01')
# xmx <- as.Date('2001-12-31')
# png(paste(export_path,"/hydrograph_Qreach_Qout_",xmn,"_",xmx,"_",runid_i,".png",sep=""), width = 1100, height = 600)
# #png(paste(export_path,"/hydrograph_Qnatural_Qintake_",xmn,"_",xmx,"_",runid_i,".png",sep=""), width = 1100, height = 600)
# ymn <- 0
# ymx <- 110
# par(mar = c(5,5,2,5))
# plot(as.numeric(fac_df$Qreach)~as.Date(fac_df$date),type = "l", lty=2, lwd = 1,
#      ylim=c(ymn,ymx),xlim=c(xmn,xmx),ylab="Flow (cfs)",xlab=paste("\nDate\n",xmn,"to",xmx))
# par(new = TRUE)
# plot(as.numeric(fac_df$Qout)~as.Date(fac_df$date),type = "l",col='brown3', lwd = 2,
#      axes=FALSE,ylim=c(ymn,ymx),xlim=c(xmn,xmx),ylab="",xlab="")
# legend("topright",legend=c("Flow (Natural)",legend_text_i),col=c("black","brown3"), lty=c(2,1), lwd=c(1,2), cex=1)
# dev.off()
# LOG Y-AXIS ------------------------------------------------------------
xmn <- as.Date('2001-01-01')
xmx <- as.Date('2001-12-31')
png(paste(export_path,"/hydrograph_Qlocal_Qout_",xmn,"_",xmx,"_",runid_i,"_log.png",sep=""), width = 1100, height = 600)
ymn <- 0
ymx <- 110
par(mar = c(5,5,2,5))
plot(as.numeric(rseg_df$Qlocal)~as.Date(rseg_df$date), log="y",type = "l", lty=2, lwd = 1,
xlim=c(xmn,xmx),ylab="Flow (cfs)",xlab=paste("\nDate\n",xmn,"to",xmx))
par(new = TRUE)
plot(as.numeric(rseg_df$Qout)~as.Date(rseg_df$date), log="y",type = "l",col='brown3', lwd = 2,
axes=FALSE,xlim=c(xmn,xmx),ylab="",xlab="")
legend("topright",legend=c("Qlocal","Qout"),col=c("black","brown3"), lty=c(2,1), lwd=c(1,2), cex=1)
dev.off()
# WET PERIOD PLOT
# # REGULAR Y-AXIS ------------------------------------------------------------
# xmn <- as.Date('2003-01-01')
# xmx <- as.Date('2003-12-31')
# png(paste(export_path,"/hydrograph_Qnatural_Qintake_",xmn,"_",xmx,"_",runid_i,".png",sep=""), width = 1100, height = 600)
# ymn <- 0
# ymx <- 110
# par(mar = c(5,5,2,5))
# plot(as.numeric(fac_df$Qnatural)~as.Date(fac_df$date),type = "l", lty=2, lwd = 1,
#      ylim=c(ymn,ymx),xlim=c(xmn,xmx),ylab="Flow (cfs)",xlab=paste("\nDate\n",xmn,"to",xmx))
# par(new = TRUE)
# plot(as.numeric(fac_df$Qintake)~as.Date(fac_df$date),type = "l",col='brown3', lwd = 2, axes=FALSE,ylim=c(ymn,ymx),xlim=c(xmn,xmx),ylab="",xlab="")
# legend("topright",legend=c("Flow (Natural)",legend_text_i),col=c("black","brown3"), lty=c(2,1), lwd=c(1,2), cex=1)
# dev.off()
# LOG Y-AXIS ------------------------------------------------------------
xmn <- as.Date('2003-01-01')
xmx <- as.Date('2003-12-31')
png(paste(export_path,"/hydrograph_Qlocal_Qout_",xmn,"_",xmx,"_",runid_i,"_log.png",sep=""), width = 1100, height = 600)
ymn <- 0
ymx <- 110
par(mar = c(5,5,2,5))
plot(as.numeric(rseg_df$Qlocal)~as.Date(rseg_df$date), log="y",type = "l", lty=2, lwd = 1,
xlim=c(xmn,xmx),ylab="Flow (cfs)",xlab=paste("\nDate\n",xmn,"to",xmx))
par(new = TRUE)
plot(as.numeric(rseg_df$Qout)~as.Date(rseg_df$date), log="y",type = "l",col='brown3', lwd = 2,
axes=FALSE,xlim=c(xmn,xmx),ylab="",xlab="")
legend("topright",legend=c("Qlocal","Qout"),col=c("black","brown3"), lty=c(2,1), lwd=c(1,2), cex=1)
dev.off()
}
################################################################################################
################################################################################################
################################################################################################
# # NUMBER OF DAYS STORAGE IS BELOW 50%
# maxcapacity <- 1941.47
# capaity50pct <- maxcapacity*0.5
#
# #400
# rseg_bc_dat_400 <- om_get_rundata(352078, 400, site = omsite)
# rseg_bc_dat_400_df <- data.frame(rseg_bc_dat_400)
#
# imp_qa_400 <- sqldf(paste("select year,month,day, impoundment_Storage
#                  from 'rseg_bc_dat_400_df' WHERE impoundment_Storage <",capaity50pct,sep=""))
# length(imp_qa_400$impoundment_Storage)
#
# #600
# rseg_bc_dat_600 <- om_get_rundata(352078, 600, site = omsite)
# rseg_bc_dat_600_df <- data.frame(rseg_bc_dat_600)
#
# imp_qa_600 <- sqldf(paste("select year,month,day, impoundment_Storage
#                  from 'rseg_bc_dat_600_df' WHERE impoundment_Storage <",capaity50pct,sep=""))
# length(imp_qa_600$impoundment_Storage)
#
# #2
# rseg_bc_dat_2 <- om_get_rundata(352078, 2, site = omsite)
# rseg_bc_dat_2_df <- data.frame(rseg_bc_dat_2)
#
# imp_qa_2 <- sqldf(paste("select year,month,day, impoundment_Storage
#                  from 'rseg_bc_dat_2_df' WHERE impoundment_Storage <",capaity50pct,sep=""))
# length(imp_qa_2$impoundment_Storage)
################################################################################################
################################################################################################
png(file=paste(export_path,"fdc_",runid_i,".png",sep=""),width=560, height=450)
hydroTSM::fdc(
cbind(dat_join$Qlocal, dat_join$Qout),
#cbind(dat_join$Qnatural, dat_join$Qout),
yat = c(0.10,1,5,10,25,100,400),
leg.txt = c("Qlocal","Qout"),
ylab = "Q, [cfs]",
ylim=c(0, 500)
)
dev.off()
quantile(dat_join$Qlocal, probs=c(0,0.1,0.25,0.5,0.75,0.9,1.0))
quantile(dat_join$Qout, probs=c(0,0.1,0.25,0.5,0.75,0.9,1.0))
png(file=paste(export_path,"fdc_",runid_i,".png",sep=""),width=560, height=450)
hydroTSM::fdc(
cbind(dat_join$Qlocal, dat_join$Qout),
#cbind(dat_join$Qnatural, dat_join$Qout),
yat = c(0.10,1,5,10,25,100,400),
leg.txt = c("Qlocal","Qout"),
ylab = "Q, [cfs]",
ylim=c(0, 600)
)
dev.off()
View(rseg_df)
rseg.dat <- om_get_rundata(elid=rseg_om_id,runid=runid,site=site) #automatically cuts out model warm-up periods
rseg.dat.df <- data.frame(rseg.dat)
rseg_qa <- sqldf("select year,month,day, local_channel_Qout, Qlocal, Qreach, Qout
from 'rseg.dat.df' WHERE year = 2001 AND month = 11")
View(rseg_qa)
rmarkdown::render('C:/Users/nrf46657/Desktop/VAHydro Development/GitHub/vahydro/R/R/permitting/Route 58/VWP_CIA_Summary_Rt58.Rmd', params = list( rseg.hydroid = 480240, fac.hydroid = 475973, runid.list = c("runid_600"), intake_stats_runid = 600))
rmarkdown::render('C:/Users/nrf46657/Desktop/VAHydro Development/GitHub/vahydro/R/permitting/Route 58/VWP_CIA_Summary_Rt58.Rmd', params = list( rseg.hydroid = 480240, fac.hydroid = 475973, runid.list = c("runid_600"), intake_stats_runid = 600))
rmarkdown::render('C:/Users/nrf46657/Desktop/VAHydro Development/GitHub/vahydro/R/permitting/Route 58/VWP_CIA_Summary_Rt58.Rmd', params = list( rseg.hydroid = 480240, fac.hydroid = 475973, runid.list = c("runid_600"), intake_stats_runid = 600))
