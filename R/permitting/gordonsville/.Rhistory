rmarkdown::render('C:/Users/nrf46657/Desktop/GitHub/vahydro/R/examples/VWP_CIA_Summary.Rmd',
output_file ='C:/Users/nrf46657/Desktop/VWP Modeling/vwp - Gordonsville Power Station/Gordonsville_TE_11',
params = list(doc_title = "VWP CIA Summary - Gordonsville Power Station",
rseg.hydroid = 68223,
fac.hydroid = 72548,
runid.list = c("runid_11"),
rseg.metric.list = c("Qout","l30_Qout","l90_Qout","consumptive_use_frac","wd_cumulative_mgd","ps_cumulative_mgd","wd_mgd","ps_mgd"),
intake_stats_runid = 11,
preferred_runid = "runid_11",
upstream_rseg_ids=c(68113,68120),
users_metric = "base_demand_mgy"
)
)
rmarkdown::render('C:/Users/nrf46657/Desktop/GitHub/vahydro/R/examples/VWP_CIA_Summary.Rmd',
output_file ='C:/Users/nrf46657/Desktop/VWP Modeling/vwp - Gordonsville Power Station/Gordonsville_TE_11',
params = list(doc_title = "VWP CIA Summary - Gordonsville Power Station",
rseg.hydroid = 68120,
fac.hydroid = 73049,
runid.list = c("runid_11"),
rseg.metric.list = c("Qout","l30_Qout","l90_Qout","consumptive_use_frac","wd_cumulative_mgd","ps_cumulative_mgd","wd_mgd","ps_mgd"),
intake_stats_runid = 11,
preferred_runid = "runid_11",
upstream_rseg_ids=c(68113,68120),
users_metric = "base_demand_mgy"
)
)
rmarkdown::render('C:/Users/nrf46657/Desktop/GitHub/vahydro/R/examples/VWP_CIA_Summary.Rmd',
output_file ='C:/Users/nrf46657/Desktop/VWP Modeling/vwp - Gordonsville Power Station/Gordonsville_TE_11',
params = list(doc_title = "VWP CIA Summary - Gordonsville Power Station",
rseg.hydroid = 68120,
fac.hydroid = 73049,
runid.list = c("runid_11"),
rseg.metric.list = c("Qout","l30_Qout","l90_Qout","consumptive_use_frac","wd_cumulative_mgd","ps_cumulative_mgd","wd_mgd","ps_mgd"),
intake_stats_runid = 11,
preferred_runid = "runid_11",
upstream_rseg_ids=c(67823,68113),
users_metric = "base_demand_mgy"
)
)
rmarkdown::render('C:/Users/nrf46657/Desktop/GitHub/vahydro/R/examples/VWP_CIA_Summary.Rmd',
output_file ='C:/Users/nrf46657/Desktop/VWP Modeling/vwp - Gordonsville Power Station/Gordonsville_TE_11',
params = list(doc_title = "VWP CIA Summary - Gordonsville Power Station",
rseg.hydroid = 68120,
fac.hydroid = 73049,
runid.list = c("runid_11"),
rseg.metric.list = c("Qout","l30_Qout","l90_Qout","consumptive_use_frac","wd_cumulative_mgd","ps_cumulative_mgd","wd_mgd","ps_mgd"),
intake_stats_runid = 11,
preferred_runid = "runid_11",
upstream_rseg_ids=c(67823,68113),
users_metric = "base_demand_mgy"
)
)
rmarkdown::render('C:/Users/nrf46657/Desktop/GitHub/vahydro/R/examples/VWP_CIA_Summary.Rmd',
output_file ='C:/Users/nrf46657/Desktop/VWP Modeling/vwp - Gordonsville Power Station/Gordonsville_TE_11',
params = list(doc_title = "VWP CIA Summary - Gordonsville Power Station",
rseg.hydroid = 68120,
fac.hydroid = 73049,
runid.list = c("runid_11"),
rseg.metric.list = c("Qout","l30_Qout","l90_Qout","consumptive_use_frac","wd_cumulative_mgd","ps_cumulative_mgd","wd_mgd","ps_mgd"),
intake_stats_runid = 11,
preferred_runid = "runid_11",
upstream_rseg_ids=c(67823,68113),
users_metric = "base_demand_mgy"
)
)
rmarkdown::render('C:/Users/nrf46657/Desktop/GitHub/vahydro/R/examples/VWP_CIA_Summary.Rmd',
output_file ='C:/Users/nrf46657/Desktop/VWP Modeling/vwp - Gordonsville Power Station/Gordonsville_TE_11',
params = list(doc_title = "VWP CIA Summary - Gordonsville Power Station",
rseg.hydroid = 68120,
fac.hydroid = 73049,
runid.list = c("runid_11"),
rseg.metric.list = c("Qout","l30_Qout","l90_Qout","consumptive_use_frac","wd_cumulative_mgd","ps_cumulative_mgd","wd_mgd","ps_mgd"),
intake_stats_runid = 11,
preferred_runid = "runid_11",
upstream_rseg_ids=c(67823,68113),
users_metric = "base_demand_mgy"
)
)
library('hydrotools')
library('zoo')
library('knitr') # needed for kable()
basepath='/var/www/R';
source("/var/www/R/config.R")
source("https://raw.githubusercontent.com/HARPgroup/hydro-tools/master/R/fac_utils.R")
rseg_om_id <- 258123 # Rapidan River
fac_om_id <- 348716 # WILDERNESS SERVICE AREA:Rapidan River
runid <- 6001
facdat <- om_get_rundata(fac_om_id, runid, site = omsite)
rsegdat <- om_get_rundata(rseg_om_id, runid, site = omsite)
mstart <- zoo::as.Date(as.POSIXct(min(index(rsegdat)),origin="1970-01-01"))
mend <- zoo::as.Date(as.POSIXct(max(index(rsegdat)),origin="1970-01-01"))
facdat_df <- data.frame(facdat)
rsegdat_df <- data.frame(rsegdat)
sort(colnames(rsegdat_df))
sort(colnames(facdat_df))
SML <- om_quantile_table(facdat_df, metrics = c("wd_mgd"),
rdigits = 3)
kable(SML,'markdown')
facdat_df$impoundment_use_remain_mg
sort(colnames(facdat_df))
SML <- om_quantile_table(facdat_df, metrics = c("wd_mgd","unmet_demand_mgd"),
rdigits = 3)
kable(SML,'markdown')
SML <- om_quantile_table(facdat_df, metrics = c("wd_mgd","unmet_demand_mgd", "Qintake"),
rdigits = 3)
kable(SML,'markdown')
rivseg = 'RU4_6040_6030'
# Get all segs above rivseg of interest
# Read data that requires file download
download_read <- function(url, filetype, zip) {
localpath <- tempdir()
filename <- basename(url)
filepath <- paste(localpath,"\\", filename, sep="")
download.file(url, filepath)
if(zip==TRUE){
folder <- unzip(filepath, exdir=localpath)
filepath <- grep(".*.csv.*", folder, value=TRUE)
}
if(filetype=="csv"){
df <- read.csv(file=filepath, header=TRUE, sep=",")
}
if(filetype=="shp"){
layer <- gsub("\\.zip", "", filename)
df <- read_sf(dsn=localpath, layer=layer)
}
if(filetype!="csv" & filetype!="shp"){
message(paste("Error in download_read(): filetype must be 'csv' or 'shp'"))
}
return(df)
}
segs <- list()
segs$all <- download_read(url=paste(site,"/vahydro_riversegs_export",sep=""), filetype="csv", zip=FALSE)
segs$all$riverseg <- str_replace(segs$all$hydrocode, 'vahydrosw_wshed_', '') #prerequisite for fn_extract_basin()
upstream_segs <- fn_extract_basin(segs$all, rivseg)
print(upstream_segs$riverseg)
print(upstream_segs$hydroid)
rmarkdown::render('C:/Users/nrf46657/Desktop/GitHub/vahydro/R/examples/VWP_CIA_Summary.Rmd',
output_file ='C:/Users/nrf46657/Desktop/VWP Modeling/vwp - Wilderness WTP/Wilderness_WTP_TE_6001',
params = list(doc_title = "VWP CIA Summary - Wilderness WTP",
rseg.hydroid = 68230,
fac.hydroid = 73075,
runid.list = c("runid_6001"),
rseg.metric.list = c("Qout","l30_Qout","l90_Qout","consumptive_use_frac","wd_cumulative_mgd","ps_cumulative_mgd","wd_mgd","ps_mgd"),
intake_stats_runid = 6001,
preferred_runid = "runid_6001",
upstream_rseg_ids=c(68127,67706,68371,68140,68227,68226,68230),
users_metric = "base_demand_mgy"
)
)
rmarkdown::render('C:/Users/nrf46657/Desktop/GitHub/vahydro/R/examples/VWP_CIA_Summary.Rmd',
output_file ='C:/Users/nrf46657/Desktop/VWP Modeling/vwp - Wilderness WTP/Wilderness_WTP_TE_6001',
params = list(doc_title = "VWP CIA Summary - Wilderness WTP",
rseg.hydroid = 68230,
fac.hydroid = 73075,
runid.list = c("runid_6001"),
rseg.metric.list = c("Qout","l30_Qout","l90_Qout","consumptive_use_frac","wd_cumulative_mgd","ps_cumulative_mgd","wd_mgd","ps_mgd"),
intake_stats_runid = 6001,
preferred_runid = "runid_6001",
upstream_rseg_ids=c(68127,67706,68371,68140,68227,68226),
users_metric = "base_demand_mgy"
)
)
